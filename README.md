# 这里是关于全国大学生数学建模大赛2022E题的代码实现。


## 2022年高教社杯全国大学生数学建模竞赛E题小批量物料的生产安排


### 问题 1 请对附件中的历史数据进行分析，选择 6 种应当重点关注的物料（可从物料需求出现的频数、数量、趋势和销售单价等方面考虑），建立物料需求的周预测模型（即以周为基本时间单位，预测物料的周需求量，见附录(1)），并利用历史数据对预测模型进行评价。

### ## 1.1.1 对历史数据进行分析，选择六种应当重点关注的物料
### 通过对附件中的历史数据进行分析，我们可以从以下几个方面来选择六种应当重点关注的物料：
1. **物料需求出现的频数**：统计每种物料在历史数据中出现的次数，频数高的物料可能是生产中常用的。
2. **物料需求数量**：计算每种物料的总需求量，需求量大的物料可能是生产中重要的原材料。
3. **物料需求趋势**：分析每种物料的需求趋势，观察其是否有上升或下降的趋势。
4. **销售单价**：考虑物料的销售单价，价格较高的物料可能对生产成本有较大影响。
### 通过以上几个方面的分析，我们可以选择出六种应当重点关注的物料。

## 1.1.2 建立物料需求的周预测模型（即以周为基本时间单位，预测物料的周需求量）

### 在建立物料需求的周预测模型时，我们可以采用以下步骤：
1. **数据预处理**：将历史数据按照周进行汇总，计算每种物料在每周的总需求量。
2. **选择预测模型**：可以选择时间序列分析方法（如ARIMA模型）、回归分析方法或机器学习方法（如随机森林、XGBoost等）来建立预测模型。
3. **模型训练**：使用历史数据对选择的预测模型进行训练，调整模型参数以提高预测精度。
4. **模型验证**：使用一部分历史数据作为验证集，对模型进行验证，评估其预测精度。
5. **模型应用**：将训练好的模型应用于未来的物料需求预测，得到每种物料的周需求量预测结果。
6. **结果分析**：对预测结果进行分析，观察各物料的需求变化趋势，并根据预测结果制定相应的生产计划。

## 问题2
### 如果按照物料需求量的预测值来安排生产，可能会产生较大的库存，或者出现较多的缺货，给企业带来经济和信誉方面的损失。企业希望从需求量的预测值、需求特征、库存量和缺货量等方面综合考虑，以便更合理地安排生产。请提供一种制定生产计划的方法，从第 101 周（见附录(1)）开始，在每周初，制定本周的物料生产计划（见附录(2)），安排生产，直至第 177 周为止，使得平均服务水平不低于 85%（见附录(3)）。这里假设：本周计划生产的物料，只能在下周及以后使用。为便于统一计算结果，进一步假设第 100 周末的库存量和缺货量均为零，第 100 周的生产计划数恰好等于第 101 周的实际需求数。请在问题 1 选定的 6 种物料中选择一种物料，将其第 101 ∼ 110 周的生产计划数、实际需求量、库存量、缺货量（见附录(4)）和服务水平按表 1 的形式填写，放在正文中。  

#### 2.1.1 从需求量的预测值、需求特征、库存量和缺货量等方面综合考虑，制定生产计划。

- 在制定生产计划时，我们需要综合考虑以下几个方面：
1. **需求量的预测值**：使用问题1中建立的物料需求预测模型，获取每周的物料需求预测值。
2. **需求特征**：分析物料的需求特征，如季节性、周期性等，了解物料需求的变化规律。
3. **库存量**：考虑当前的库存量，确保生产计划不会导致库存过高或过低。
4. **缺货量**：分析历史数据中的缺货情况，确保生产计划能够满足实际需求，避免缺货。
#### 2.1.2 制定生产计划的方法
- 在综合考虑以上因素后，我们可以采用以下方法制定生产计划：
1. **需求预测**：使用问题1中建立的物料需求预测模型，获取第101周至第110周的物料需求预测值。
2. **库存管理**：根据当前的库存量和预测的需求量，计算每周需要生产的物料数量，以确保库存水平在合理范围内。
3. **缺货控制**：根据历史数据中的缺货情况，设定一个缺货量的阈值，确保生产计划能够满足实际需求，避免缺货。
4. **服务水平**：计算每周的服务水平，确保平均服务水平不低于85%。如果某周的服务水平低于85%，需要调整生产计划以提高服务水平。
5. **动态调整**：在每周初，根据实际需求和库存情况，动态调整生产计划，以适应变化的需求和库存水平。

## 附录
- 附录1 将附件数据第 1 次出现的时间（2019 年 1 月 2 日）所在的周设定为第 1 周，以后的每周从周一开始至周日结束，例如，2019 年 1 月 7 日至 13 日为第 2 周，以此类推。
- 附录2 在制定本周的生产计划时，可以使用任何历史数据、需求特征以及预测数据，但不能使用本周及本周以后的实际需求数据。
- 附录3 服务水平 = 1 −缺货量/实际需求量。
- 附录4 库存量和缺货量分别指物料在周末的库存量和缺货量。

